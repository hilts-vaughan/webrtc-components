var RoomOptions_1 = require('./RoomOptions');
var StreamRoom_1 = require('./StreamRoom');
var RoomService = (function () {
    function RoomService(config) {
        this.config = config;
        this.socket = this.getSocket();
    }
    RoomService.prototype.sendExternalMessage = function (key, message, callback) {
        this.socket.emit(key, message, function (response) {
            callback(response);
        });
    };
    RoomService.prototype.findRooms = function (filter, callback) {
        if (filter == null) {
            console.warn("[RoomService] If you wanted all results, pass in an empty string. Fixing this for you this time...");
            filter = '';
        }
        this.socket.emit('findRooms', { filter: filter }, function (results) {
            var optionizedResults = [];
            results.forEach(function (room) {
                var roomOption = new RoomOptions_1.RoomOptions(room, false);
                optionizedResults.push(roomOption);
            });
            callback(optionizedResults);
        });
    };
    RoomService.prototype.createRoom = function (options, callback) {
        if (options == null || callback == null) {
            throw Error("Options or callback cannot be null.");
        }
        this.socket.emit('createRoom', options, function (success) {
            callback(success);
        });
    };
    RoomService.prototype.joinRoom = function (options, streams, callback) {
        if (options == null || streams == null) {
            callback(false);
        }
        var roomSocket = this.getSocket();
        roomSocket.emit('joinRoom', options, function (success, token) {
            if (success) {
                var context = new StreamRoom_1.StreamRoom(streams, options, roomSocket, token);
                callback(success, context);
            }
            else {
                callback(false, null);
            }
        });
    };
    RoomService.prototype.getSocket = function () {
        var socket = io.connect(this.config.url, { resource: 'A/socket.io', 'force new connection': true });
        return socket;
    };
    return RoomService;
})();
exports.RoomService = RoomService;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL3J0Y19hcGkvUm9vbVNlcnZpY2UudHMiXSwibmFtZXMiOlsiUm9vbVNlcnZpY2UiLCJSb29tU2VydmljZS5jb25zdHJ1Y3RvciIsIlJvb21TZXJ2aWNlLnNlbmRFeHRlcm5hbE1lc3NhZ2UiLCJSb29tU2VydmljZS5maW5kUm9vbXMiLCJSb29tU2VydmljZS5jcmVhdGVSb29tIiwiUm9vbVNlcnZpY2Uuam9pblJvb20iLCJSb29tU2VydmljZS5nZXRTb2NrZXQiXSwibWFwcGluZ3MiOiJBQUFBLDRCQUEwQixlQUMxQixDQUFDLENBRHdDO0FBRXpDLDJCQUF5QixjQU16QixDQUFDLENBTnNDO0FBTXZDO0lBUUNBLHFCQUFZQSxNQUErQkE7UUFDMUNDLElBQUlBLENBQUNBLE1BQU1BLEdBQUdBLE1BQU1BLENBQUNBO1FBQ3JCQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxTQUFTQSxFQUFFQSxDQUFDQTtJQUNoQ0EsQ0FBQ0E7SUFFTUQseUNBQW1CQSxHQUExQkEsVUFBMkJBLEdBQVlBLEVBQUVBLE9BQWdCQSxFQUFFQSxRQUFtQkE7UUFDN0VFLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLEVBQUVBLE9BQU9BLEVBQUVBLFVBQUNBLFFBQWlCQTtZQUNoREEsUUFBUUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFDcEJBLENBQUNBLENBQUNBLENBQUNBO0lBQ0pBLENBQUNBO0lBU01GLCtCQUFTQSxHQUFoQkEsVUFBaUJBLE1BQWNBLEVBQUVBLFFBQWtDQTtRQUNsRUcsRUFBRUEsQ0FBQ0EsQ0FBQ0EsTUFBTUEsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDcEJBLE9BQU9BLENBQUNBLElBQUlBLENBQUNBLG9HQUFvR0EsQ0FBQ0EsQ0FBQ0E7WUFDbkhBLE1BQU1BLEdBQUdBLEVBQUVBLENBQUNBO1FBQ2JBLENBQUNBO1FBRURBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLEVBQUVBLEVBQUVBLE1BQU1BLEVBQUVBLE1BQU1BLEVBQUVBLEVBQUVBLFVBQUNBLE9BQXNCQTtZQUN4RUEsSUFBSUEsaUJBQWlCQSxHQUF1QkEsRUFBRUEsQ0FBQ0E7WUFDL0NBLE9BQU9BLENBQUNBLE9BQU9BLENBQUNBLFVBQUNBLElBQUlBO2dCQUVwQkEsSUFBSUEsVUFBVUEsR0FBZ0JBLElBQUlBLHlCQUFXQSxDQUFDQSxJQUFJQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtnQkFDM0RBLGlCQUFpQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsQ0FBQ0E7WUFDcENBLENBQUNBLENBQUNBLENBQUNBO1lBRUhBLFFBQVFBLENBQUNBLGlCQUFpQkEsQ0FBQ0EsQ0FBQ0E7UUFDN0JBLENBQUNBLENBQUNBLENBQUNBO0lBQ0pBLENBQUNBO0lBTU1ILGdDQUFVQSxHQUFqQkEsVUFBa0JBLE9BQW9CQSxFQUFFQSxRQUFrQkE7UUFDekRJLEVBQUVBLENBQUNBLENBQUNBLE9BQU9BLElBQUlBLElBQUlBLElBQUlBLFFBQVFBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1lBQ3pDQSxNQUFNQSxLQUFLQSxDQUFDQSxxQ0FBcUNBLENBQUNBLENBQUNBO1FBQ3BEQSxDQUFDQTtRQUVEQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxZQUFZQSxFQUFFQSxPQUFPQSxFQUFFQSxVQUFDQSxPQUFPQTtZQUMvQ0EsUUFBUUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0E7UUFDbkJBLENBQUNBLENBQUNBLENBQUNBO0lBQ0pBLENBQUNBO0lBU01KLDhCQUFRQSxHQUFmQSxVQUFnQkEsT0FBb0JBLEVBQUVBLE9BQTJCQSxFQUFFQSxRQUFrQkE7UUFDcEZLLEVBQUVBLENBQUNBLENBQUNBLE9BQU9BLElBQUlBLElBQUlBLElBQUlBLE9BQU9BLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1lBQ3hDQSxRQUFRQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQTtRQUNqQkEsQ0FBQ0E7UUFJREEsSUFBSUEsVUFBVUEsR0FBV0EsSUFBSUEsQ0FBQ0EsU0FBU0EsRUFBRUEsQ0FBQ0E7UUFFMUNBLFVBQVVBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEVBQUVBLE9BQU9BLEVBQUVBLFVBQUNBLE9BQU9BLEVBQUVBLEtBQUtBO1lBQ25EQSxFQUFFQSxDQUFDQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDYkEsSUFBSUEsT0FBT0EsR0FBZUEsSUFBSUEsdUJBQVVBLENBQUNBLE9BQU9BLEVBQUVBLE9BQU9BLEVBQUVBLFVBQVVBLEVBQUVBLEtBQUtBLENBQUNBLENBQUNBO2dCQUM5RUEsUUFBUUEsQ0FBQ0EsT0FBT0EsRUFBRUEsT0FBT0EsQ0FBQ0EsQ0FBQ0E7WUFDNUJBLENBQUNBO1lBQ0RBLElBQUlBLENBQUNBLENBQUNBO2dCQUNMQSxRQUFRQSxDQUFDQSxLQUFLQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUN2QkEsQ0FBQ0E7UUFDRkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFDSkEsQ0FBQ0E7SUFFT0wsK0JBQVNBLEdBQWpCQTtRQUNDTSxJQUFJQSxNQUFNQSxHQUFXQSxFQUFFQSxDQUFDQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxHQUFHQSxFQUFFQSxFQUFDQSxRQUFRQSxFQUFFQSxhQUFhQSxFQUFFQSxzQkFBc0JBLEVBQUVBLElBQUlBLEVBQUNBLENBQUNBLENBQUNBO1FBQzFHQSxNQUFNQSxDQUFDQSxNQUFNQSxDQUFDQTtJQUNmQSxDQUFDQTtJQUNGTixrQkFBQ0E7QUFBREEsQ0F6RkEsQUF5RkNBLElBQUE7QUF6RlksbUJBQVcsY0F5RnZCLENBQUEiLCJmaWxlIjoic2VydmljZXMvcnRjX2FwaS9Sb29tU2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Um9vbU9wdGlvbnN9IGZyb20gJy4vUm9vbU9wdGlvbnMnXG5pbXBvcnQge0NvbnRyb2xsZXJDb25maWd1cmF0aW9ufSBmcm9tICcuL0NvbnRyb2xsZXJDb25maWd1cmF0aW9uJ1xuaW1wb3J0IHtTdHJlYW1Sb29tfSBmcm9tICcuL1N0cmVhbVJvb20nXG5cbi8qKlxuICogUHJvdmlkZXMgc2VydmljZXMgaW4gcmVsYXRpb24gdG8gcm9vbSBtYW5hZ2VtZW50LCBhcyBwcm92aWRlZCBieSBhIFJ0Y0NvbnRyb2xsZXIuIERvIG5vdCBjcmVhdGUgYW4gaW5zdGFuY2Ugb2YgdGhpcyBkaXJlY3RseS5cbiAqIFlvdSBzaG91bGQgYmUgYWJsZSB0byBnZXQgc2luZ2xlIGluc3RhbmNlIHRocm91Z2ggeW91ciBSdGNDb250cm9sbGVyLlxuICovXG5leHBvcnQgY2xhc3MgUm9vbVNlcnZpY2Uge1xuXG5cdHByaXZhdGUgY29uZmlnOiBDb250cm9sbGVyQ29uZmlndXJhdGlvbjtcblx0cHVibGljIHNvY2tldDogU29ja2V0O1xuXG5cdC8qKlxuXHQgKiBAcGFyYW1cdFNJR05BTElOR19VUkxfT1BUSU9OXHRUaGUgVVJMIG9mIHRoZSBzaWduYWxsaW5nIHNlcnZlciB0byBiZSBjb25uZWN0ZWQgdG8uXG5cdCAqL1xuXHRjb25zdHJ1Y3Rvcihjb25maWc6IENvbnRyb2xsZXJDb25maWd1cmF0aW9uKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdFx0dGhpcy5zb2NrZXQgPSB0aGlzLmdldFNvY2tldCgpO1xuXHR9XG5cblx0cHVibGljIHNlbmRFeHRlcm5hbE1lc3NhZ2Uoa2V5IDogc3RyaW5nLCBtZXNzYWdlIDogT2JqZWN0LCBjYWxsYmFjayA6IEZ1bmN0aW9uKSAge1xuXHRcdHRoaXMuc29ja2V0LmVtaXQoa2V5LCBtZXNzYWdlLCAocmVzcG9uc2UgOiBPYmplY3QpID0+IHtcblx0XHRcdGNhbGxiYWNrKHJlc3BvbnNlKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBQcm92aWRlcyBhIGZpbHRlcmluZyBhZmZvcmRhbmNlIGZvciByb29tcy4gSWYgeW91IHdhbnQgdG8gZmluZCBhbGwgcm9vbXMsIHN1cHBseSBhIGJsYW5rIHN0cmluZyBhcyB0aGUgZmlsdGVyaW5nIHBhcmFtZXRlci5cblx0ICogSWYgeW91IGFyZSBpbnRlcmVzdGluZyBpbiBnZXR0aW5nIG5vdGlmaWNhdGlvbnMsIHVzZSBhIGRpZmZlcmVudCBtZWNoYW5pc20gZm9yIHRoaXMuIFRoaXMgaXMgYSBvbmUgdGltZSBxdWVyeS5cblx0ICpcblx0ICogQSBjYWxsYmFjayB3aXRoIGEgbGlzdGluZyBvZiB7Um9vbU9wdGlvbnN9IHdpbGwgYmUgcHJvdmlkZWQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlci4gSWYgbm8gcm9vbXMgd2VyZSBmb3VuZCwgdGhlIGxpc3Rcblx0ICogd2lsbCBiZSBlbXB0eS5cblx0ICovXG5cdHB1YmxpYyBmaW5kUm9vbXMoZmlsdGVyOiBzdHJpbmcsIGNhbGxiYWNrOiBSb29tRmlsdGVyUmVzdWx0Q2FsbGJhY2spOiB2b2lkIHtcblx0XHRpZiAoZmlsdGVyID09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIltSb29tU2VydmljZV0gSWYgeW91IHdhbnRlZCBhbGwgcmVzdWx0cywgcGFzcyBpbiBhbiBlbXB0eSBzdHJpbmcuIEZpeGluZyB0aGlzIGZvciB5b3UgdGhpcyB0aW1lLi4uXCIpO1xuXHRcdFx0ZmlsdGVyID0gJyc7XG5cdFx0fVxuXG5cdFx0dGhpcy5zb2NrZXQuZW1pdCgnZmluZFJvb21zJywgeyBmaWx0ZXI6IGZpbHRlciB9LCAocmVzdWx0czogQXJyYXk8c3RyaW5nPikgPT4ge1xuXHRcdFx0dmFyIG9wdGlvbml6ZWRSZXN1bHRzOiBBcnJheTxSb29tT3B0aW9ucz4gPSBbXTtcblx0XHRcdHJlc3VsdHMuZm9yRWFjaCgocm9vbSkgPT4ge1xuXHRcdFx0XHQvLyBUT0RPOiBUaGUgcHJpdmF0ZSBzcGVjIGlzIG5vdCBzdXBwb3J0ZWQgYnkgbW9zdCBzaWduYWxsaW5nIHNlcnZlciBjb3JlcyBhcyBpcy5cblx0XHRcdFx0dmFyIHJvb21PcHRpb246IFJvb21PcHRpb25zID0gbmV3IFJvb21PcHRpb25zKHJvb20sIGZhbHNlKTtcblx0XHRcdFx0b3B0aW9uaXplZFJlc3VsdHMucHVzaChyb29tT3B0aW9uKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRjYWxsYmFjayhvcHRpb25pemVkUmVzdWx0cyk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIHJvb20gd2l0aCB0aGUgZ2l2ZW4gb3B0aW9ucy4gSWYgaXQgd2FzIGEgc3VjY2VzcywgYSBjYWxsYmFjayB3aWxsIGJlIGludm9rZSB3aXRoIHRydWUuIE90aGVyd2lzZSwgdGhlIGNhbGxiYWNrXG5cdCAqIHdpbGwgYmUgaW52b2tlZCB3aXRoIHRoZSBwYXJhbWV0ZXIgZmFsc2UuXG5cdCAqL1xuXHRwdWJsaWMgY3JlYXRlUm9vbShvcHRpb25zOiBSb29tT3B0aW9ucywgY2FsbGJhY2s6IEZ1bmN0aW9uKSB7XG5cdFx0aWYgKG9wdGlvbnMgPT0gbnVsbCB8fCBjYWxsYmFjayA9PSBudWxsKSB7XG5cdFx0XHR0aHJvdyBFcnJvcihcIk9wdGlvbnMgb3IgY2FsbGJhY2sgY2Fubm90IGJlIG51bGwuXCIpO1xuXHRcdH1cblxuXHRcdHRoaXMuc29ja2V0LmVtaXQoJ2NyZWF0ZVJvb20nLCBvcHRpb25zLCAoc3VjY2VzcykgPT4ge1xuXHRcdFx0Y2FsbGJhY2soc3VjY2Vzcyk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogQXR0ZW1wdHMgdG8gam9pbiBhIHJvb20gd2l0aCB0aGUgZ2l2ZW4gcm9vbSBvcHRpb25zIHdpdGggdGhlIHN0cmVhbXMgcHJvdmlkZWQuIFRoZSByZXN1bHQgb2YgdGhlIG9wZXJhdGlvbiBpc1xuXHQgKiBhc3luYywgc28gaXQgd2lsbCBiZSBwcm92aWRlZCB0aHJvdWdoIHRoZSBjYWxsYmFjay4gSWYgdGhlIHN0cmVhbXMgYXJlIGludmFsaWQsIHRoZSByb29tIGlzIHVuYXZhaWxhYmxlLCBvciBhbnkgb3RoZXJcblx0ICogZXJyb3Igb2NjdXJzLCB0aGUgY2FsbGJhY2sgd2lsbCBiZSBpbnZva2Ugd2l0aCBvbmUgcGFyYW1ldGVyLCBmYWxzZS4gT3RoZXJ3aXNlLCBpdCB3aWxsIGJlIGludm9rZWQgd2l0aCB0cnVlLCBhbmQgYSBzZWNvbmRcblx0ICogcGFyYW1ldGVyIHdpbGwgZm9sbG93IHdpdGggdGhlIHJvb20gY29udGV4dCB0aGF0IGhhcyBiZWVuIGNyZWF0ZWQuXG5cdCAqXG5cdCAqL1xuXHRwdWJsaWMgam9pblJvb20ob3B0aW9uczogUm9vbU9wdGlvbnMsIHN0cmVhbXM6IEFycmF5PE1lZGlhU3RyZWFtPiwgY2FsbGJhY2s6IEZ1bmN0aW9uKSB7XG5cdFx0aWYgKG9wdGlvbnMgPT0gbnVsbCB8fCBzdHJlYW1zID09IG51bGwpIHtcblx0XHRcdGNhbGxiYWNrKGZhbHNlKTtcblx0XHR9XG5cblx0XHQvLyBOb3RlOiBBIG5ldyBzb2NrZXQgaXMgY3JlYXRlZCBoZXJlLCBhcyBhbGwgY29tbXVuaWNhdGlvbnMgZm9yIHRoYXQgc2Vzc2lvbiB3aWxsIGJlIGNyZWF0ZWQgd2l0aCB0aGlzIG5ld2x5IGFjcXVpcmVkIHNvY2tldFxuXHRcdC8vIFRoaXMgaGVscHMgcHJldmVudCB0aGUgc2l0dWF0aW9uIHdoZXJlIGEgc2Vzc2lvbiBpcyB0aWVkIHRvIGEgc2luZ2xlIHNvY2tldFxuXHRcdHZhciByb29tU29ja2V0OiBTb2NrZXQgPSB0aGlzLmdldFNvY2tldCgpO1xuXG5cdFx0cm9vbVNvY2tldC5lbWl0KCdqb2luUm9vbScsIG9wdGlvbnMsIChzdWNjZXNzLCB0b2tlbikgPT4ge1xuXHRcdFx0aWYgKHN1Y2Nlc3MpIHtcblx0XHRcdFx0dmFyIGNvbnRleHQ6IFN0cmVhbVJvb20gPSBuZXcgU3RyZWFtUm9vbShzdHJlYW1zLCBvcHRpb25zLCByb29tU29ja2V0LCB0b2tlbik7XG5cdFx0XHRcdGNhbGxiYWNrKHN1Y2Nlc3MsIGNvbnRleHQpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdGNhbGxiYWNrKGZhbHNlLCBudWxsKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0U29ja2V0KCk6IFNvY2tldCB7XG5cdFx0dmFyIHNvY2tldDogU29ja2V0ID0gaW8uY29ubmVjdCh0aGlzLmNvbmZpZy51cmwsIHtyZXNvdXJjZTogJ0Evc29ja2V0LmlvJywgJ2ZvcmNlIG5ldyBjb25uZWN0aW9uJzogdHJ1ZX0pO1xuXHRcdHJldHVybiBzb2NrZXQ7XG5cdH1cbn1cblxuaW50ZXJmYWNlIFJvb21GaWx0ZXJSZXN1bHRDYWxsYmFjayB7XG4gICAgKG1lc3NhZ2U6IEFycmF5PFJvb21PcHRpb25zPik6IHZvaWQ7XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=