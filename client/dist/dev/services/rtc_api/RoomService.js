var RoomOptions_1 = require('./RoomOptions');
var StreamRoom_1 = require('./StreamRoom');
var RoomService = (function () {
    function RoomService(config) {
        this.config = config;
        this.socket = this.getSocket();
    }
    RoomService.prototype.findRooms = function (filter, callback) {
        if (filter == null) {
            console.warn("[RoomService] If you wanted all results, pass in an empty string. Fixing this for you this time...");
            filter = '';
        }
        this.socket.emit('findRooms', { filter: filter }, function (results) {
            var optionizedResults = [];
            results.forEach(function (room) {
                var roomOption = new RoomOptions_1.RoomOptions(room, false);
                optionizedResults.push(roomOption);
            });
            callback(optionizedResults);
        });
    };
    RoomService.prototype.createRoom = function (options, callback) {
        if (options == null || callback == null) {
            throw Error("Options or callback cannot be null.");
        }
        this.socket.emit('createRoom', options, function (success) {
            callback(success);
        });
    };
    RoomService.prototype.joinRoom = function (options, streams, callback) {
        if (options == null || streams == null) {
            callback(false);
        }
        var roomSocket = this.getSocket();
        roomSocket.emit('joinRoom', options, function (success, token) {
            if (success) {
                var context = new StreamRoom_1.StreamRoom(streams, options, roomSocket, token);
                callback(success, context);
            }
            else {
                callback(false, null);
            }
        });
    };
    RoomService.prototype.getSocket = function () {
        var socket = io.connect(this.config.url, { resource: 'A/socket.io', 'force new connection': true });
        return socket;
    };
    return RoomService;
})();
exports.RoomService = RoomService;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL3J0Y19hcGkvUm9vbVNlcnZpY2UudHMiXSwibmFtZXMiOlsiUm9vbVNlcnZpY2UiLCJSb29tU2VydmljZS5jb25zdHJ1Y3RvciIsIlJvb21TZXJ2aWNlLmZpbmRSb29tcyIsIlJvb21TZXJ2aWNlLmNyZWF0ZVJvb20iLCJSb29tU2VydmljZS5qb2luUm9vbSIsIlJvb21TZXJ2aWNlLmdldFNvY2tldCJdLCJtYXBwaW5ncyI6IkFBQUEsNEJBQTBCLGVBQzFCLENBQUMsQ0FEd0M7QUFFekMsMkJBQXlCLGNBTXpCLENBQUMsQ0FOc0M7QUFNdkM7SUFRQ0EscUJBQVlBLE1BQStCQTtRQUMxQ0MsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsTUFBTUEsQ0FBQ0E7UUFDckJBLElBQUlBLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLFNBQVNBLEVBQUVBLENBQUNBO0lBQ2hDQSxDQUFDQTtJQVNNRCwrQkFBU0EsR0FBaEJBLFVBQWlCQSxNQUFjQSxFQUFFQSxRQUFrQ0E7UUFDbEVFLEVBQUVBLENBQUNBLENBQUNBLE1BQU1BLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO1lBQ3BCQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxvR0FBb0dBLENBQUNBLENBQUNBO1lBQ25IQSxNQUFNQSxHQUFHQSxFQUFFQSxDQUFDQTtRQUNiQSxDQUFDQTtRQUVEQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxFQUFFQSxFQUFFQSxNQUFNQSxFQUFFQSxNQUFNQSxFQUFFQSxFQUFFQSxVQUFDQSxPQUFzQkE7WUFDeEVBLElBQUlBLGlCQUFpQkEsR0FBdUJBLEVBQUVBLENBQUNBO1lBQy9DQSxPQUFPQSxDQUFDQSxPQUFPQSxDQUFDQSxVQUFDQSxJQUFJQTtnQkFFcEJBLElBQUlBLFVBQVVBLEdBQWdCQSxJQUFJQSx5QkFBV0EsQ0FBQ0EsSUFBSUEsRUFBRUEsS0FBS0EsQ0FBQ0EsQ0FBQ0E7Z0JBQzNEQSxpQkFBaUJBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLENBQUNBO1lBQ3BDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUVIQSxRQUFRQSxDQUFDQSxpQkFBaUJBLENBQUNBLENBQUNBO1FBQzdCQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNKQSxDQUFDQTtJQU1NRixnQ0FBVUEsR0FBakJBLFVBQWtCQSxPQUFvQkEsRUFBRUEsUUFBa0JBO1FBQ3pERyxFQUFFQSxDQUFDQSxDQUFDQSxPQUFPQSxJQUFJQSxJQUFJQSxJQUFJQSxRQUFRQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN6Q0EsTUFBTUEsS0FBS0EsQ0FBQ0EscUNBQXFDQSxDQUFDQSxDQUFDQTtRQUNwREEsQ0FBQ0E7UUFFREEsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsRUFBRUEsT0FBT0EsRUFBRUEsVUFBQ0EsT0FBT0E7WUFDL0NBLFFBQVFBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1FBQ25CQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUNKQSxDQUFDQTtJQVNNSCw4QkFBUUEsR0FBZkEsVUFBZ0JBLE9BQW9CQSxFQUFFQSxPQUEyQkEsRUFBRUEsUUFBa0JBO1FBQ3BGSSxFQUFFQSxDQUFDQSxDQUFDQSxPQUFPQSxJQUFJQSxJQUFJQSxJQUFJQSxPQUFPQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUN4Q0EsUUFBUUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0E7UUFDakJBLENBQUNBO1FBSURBLElBQUlBLFVBQVVBLEdBQVdBLElBQUlBLENBQUNBLFNBQVNBLEVBQUVBLENBQUNBO1FBRTFDQSxVQUFVQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFVQSxFQUFFQSxPQUFPQSxFQUFFQSxVQUFDQSxPQUFPQSxFQUFFQSxLQUFLQTtZQUNuREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ2JBLElBQUlBLE9BQU9BLEdBQWVBLElBQUlBLHVCQUFVQSxDQUFDQSxPQUFPQSxFQUFFQSxPQUFPQSxFQUFFQSxVQUFVQSxFQUFFQSxLQUFLQSxDQUFDQSxDQUFDQTtnQkFDOUVBLFFBQVFBLENBQUNBLE9BQU9BLEVBQUVBLE9BQU9BLENBQUNBLENBQUNBO1lBQzVCQSxDQUFDQTtZQUNEQSxJQUFJQSxDQUFDQSxDQUFDQTtnQkFDTEEsUUFBUUEsQ0FBQ0EsS0FBS0EsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDdkJBLENBQUNBO1FBQ0ZBLENBQUNBLENBQUNBLENBQUNBO0lBQ0pBLENBQUNBO0lBRU9KLCtCQUFTQSxHQUFqQkE7UUFDQ0ssSUFBSUEsTUFBTUEsR0FBV0EsRUFBRUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsRUFBRUEsRUFBQ0EsUUFBUUEsRUFBRUEsYUFBYUEsRUFBRUEsc0JBQXNCQSxFQUFFQSxJQUFJQSxFQUFDQSxDQUFDQSxDQUFDQTtRQUMxR0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7SUFDZkEsQ0FBQ0E7SUFDRkwsa0JBQUNBO0FBQURBLENBbkZBLEFBbUZDQSxJQUFBO0FBbkZZLG1CQUFXLGNBbUZ2QixDQUFBIiwiZmlsZSI6InNlcnZpY2VzL3J0Y19hcGkvUm9vbVNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1Jvb21PcHRpb25zfSBmcm9tICcuL1Jvb21PcHRpb25zJ1xuaW1wb3J0IHtDb250cm9sbGVyQ29uZmlndXJhdGlvbn0gZnJvbSAnLi9Db250cm9sbGVyQ29uZmlndXJhdGlvbidcbmltcG9ydCB7U3RyZWFtUm9vbX0gZnJvbSAnLi9TdHJlYW1Sb29tJ1xuXG4vKipcbiAqIFByb3ZpZGVzIHNlcnZpY2VzIGluIHJlbGF0aW9uIHRvIHJvb20gbWFuYWdlbWVudCwgYXMgcHJvdmlkZWQgYnkgYSBSdGNDb250cm9sbGVyLiBEbyBub3QgY3JlYXRlIGFuIGluc3RhbmNlIG9mIHRoaXMgZGlyZWN0bHkuXG4gKiBZb3Ugc2hvdWxkIGJlIGFibGUgdG8gZ2V0IHNpbmdsZSBpbnN0YW5jZSB0aHJvdWdoIHlvdXIgUnRjQ29udHJvbGxlci4gXG4gKi9cbmV4cG9ydCBjbGFzcyBSb29tU2VydmljZSB7XG5cblx0cHJpdmF0ZSBjb25maWc6IENvbnRyb2xsZXJDb25maWd1cmF0aW9uO1xuXHRwcml2YXRlIHNvY2tldDogU29ja2V0O1xuXHRcblx0LyoqXG5cdCAqIEBwYXJhbVx0U0lHTkFMSU5HX1VSTF9PUFRJT05cdFRoZSBVUkwgb2YgdGhlIHNpZ25hbGxpbmcgc2VydmVyIHRvIGJlIGNvbm5lY3RlZCB0by4gXG5cdCAqL1xuXHRjb25zdHJ1Y3Rvcihjb25maWc6IENvbnRyb2xsZXJDb25maWd1cmF0aW9uKSB7XG5cdFx0dGhpcy5jb25maWcgPSBjb25maWc7XG5cdFx0dGhpcy5zb2NrZXQgPSB0aGlzLmdldFNvY2tldCgpO1xuXHR9XG5cdFxuXHQvKipcblx0ICogUHJvdmlkZXMgYSBmaWx0ZXJpbmcgYWZmb3JkYW5jZSBmb3Igcm9vbXMuIElmIHlvdSB3YW50IHRvIGZpbmQgYWxsIHJvb21zLCBzdXBwbHkgYSBibGFuayBzdHJpbmcgYXMgdGhlIGZpbHRlcmluZyBwYXJhbWV0ZXIuXG5cdCAqIElmIHlvdSBhcmUgaW50ZXJlc3RpbmcgaW4gZ2V0dGluZyBub3RpZmljYXRpb25zLCB1c2UgYSBkaWZmZXJlbnQgbWVjaGFuaXNtIGZvciB0aGlzLiBUaGlzIGlzIGEgb25lIHRpbWUgcXVlcnkuXG5cdCAqIFxuXHQgKiBBIGNhbGxiYWNrIHdpdGggYSBsaXN0aW5nIG9mIHtSb29tT3B0aW9uc30gd2lsbCBiZSBwcm92aWRlZCBhcyB0aGUgZmlyc3QgcGFyYW1ldGVyLiBJZiBubyByb29tcyB3ZXJlIGZvdW5kLCB0aGUgbGlzdFxuXHQgKiB3aWxsIGJlIGVtcHR5LiBcblx0ICovXG5cdHB1YmxpYyBmaW5kUm9vbXMoZmlsdGVyOiBzdHJpbmcsIGNhbGxiYWNrOiBSb29tRmlsdGVyUmVzdWx0Q2FsbGJhY2spOiB2b2lkIHtcblx0XHRpZiAoZmlsdGVyID09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIltSb29tU2VydmljZV0gSWYgeW91IHdhbnRlZCBhbGwgcmVzdWx0cywgcGFzcyBpbiBhbiBlbXB0eSBzdHJpbmcuIEZpeGluZyB0aGlzIGZvciB5b3UgdGhpcyB0aW1lLi4uXCIpO1xuXHRcdFx0ZmlsdGVyID0gJyc7XG5cdFx0fVxuXG5cdFx0dGhpcy5zb2NrZXQuZW1pdCgnZmluZFJvb21zJywgeyBmaWx0ZXI6IGZpbHRlciB9LCAocmVzdWx0czogQXJyYXk8c3RyaW5nPikgPT4ge1xuXHRcdFx0dmFyIG9wdGlvbml6ZWRSZXN1bHRzOiBBcnJheTxSb29tT3B0aW9ucz4gPSBbXTtcblx0XHRcdHJlc3VsdHMuZm9yRWFjaCgocm9vbSkgPT4ge1xuXHRcdFx0XHQvLyBUT0RPOiBUaGUgcHJpdmF0ZSBzcGVjIGlzIG5vdCBzdXBwb3J0ZWQgYnkgbW9zdCBzaWduYWxsaW5nIHNlcnZlciBjb3JlcyBhcyBpcy5cblx0XHRcdFx0dmFyIHJvb21PcHRpb246IFJvb21PcHRpb25zID0gbmV3IFJvb21PcHRpb25zKHJvb20sIGZhbHNlKTtcblx0XHRcdFx0b3B0aW9uaXplZFJlc3VsdHMucHVzaChyb29tT3B0aW9uKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRjYWxsYmFjayhvcHRpb25pemVkUmVzdWx0cyk7XG5cdFx0fSk7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgcm9vbSB3aXRoIHRoZSBnaXZlbiBvcHRpb25zLiBJZiBpdCB3YXMgYSBzdWNjZXNzLCBhIGNhbGxiYWNrIHdpbGwgYmUgaW52b2tlIHdpdGggdHJ1ZS4gT3RoZXJ3aXNlLCB0aGUgY2FsbGJhY2tcblx0ICogd2lsbCBiZSBpbnZva2VkIHdpdGggdGhlIHBhcmFtZXRlciBmYWxzZS5cblx0ICovXG5cdHB1YmxpYyBjcmVhdGVSb29tKG9wdGlvbnM6IFJvb21PcHRpb25zLCBjYWxsYmFjazogRnVuY3Rpb24pIHtcblx0XHRpZiAob3B0aW9ucyA9PSBudWxsIHx8IGNhbGxiYWNrID09IG51bGwpIHtcblx0XHRcdHRocm93IEVycm9yKFwiT3B0aW9ucyBvciBjYWxsYmFjayBjYW5ub3QgYmUgbnVsbC5cIik7XG5cdFx0fVxuXG5cdFx0dGhpcy5zb2NrZXQuZW1pdCgnY3JlYXRlUm9vbScsIG9wdGlvbnMsIChzdWNjZXNzKSA9PiB7XG5cdFx0XHRjYWxsYmFjayhzdWNjZXNzKTtcblx0XHR9KTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIEF0dGVtcHRzIHRvIGpvaW4gYSByb29tIHdpdGggdGhlIGdpdmVuIHJvb20gb3B0aW9ucyB3aXRoIHRoZSBzdHJlYW1zIHByb3ZpZGVkLiBUaGUgcmVzdWx0IG9mIHRoZSBvcGVyYXRpb24gaXNcblx0ICogYXN5bmMsIHNvIGl0IHdpbGwgYmUgcHJvdmlkZWQgdGhyb3VnaCB0aGUgY2FsbGJhY2suIElmIHRoZSBzdHJlYW1zIGFyZSBpbnZhbGlkLCB0aGUgcm9vbSBpcyB1bmF2YWlsYWJsZSwgb3IgYW55IG90aGVyXG5cdCAqIGVycm9yIG9jY3VycywgdGhlIGNhbGxiYWNrIHdpbGwgYmUgaW52b2tlIHdpdGggb25lIHBhcmFtZXRlciwgZmFsc2UuIE90aGVyd2lzZSwgaXQgd2lsbCBiZSBpbnZva2VkIHdpdGggdHJ1ZSwgYW5kIGEgc2Vjb25kXG5cdCAqIHBhcmFtZXRlciB3aWxsIGZvbGxvdyB3aXRoIHRoZSByb29tIGNvbnRleHQgdGhhdCBoYXMgYmVlbiBjcmVhdGVkLlxuXHQgKiBcblx0ICovXG5cdHB1YmxpYyBqb2luUm9vbShvcHRpb25zOiBSb29tT3B0aW9ucywgc3RyZWFtczogQXJyYXk8TWVkaWFTdHJlYW0+LCBjYWxsYmFjazogRnVuY3Rpb24pIHtcblx0XHRpZiAob3B0aW9ucyA9PSBudWxsIHx8IHN0cmVhbXMgPT0gbnVsbCkge1xuXHRcdFx0Y2FsbGJhY2soZmFsc2UpO1xuXHRcdH1cdFx0XG5cdFx0XG5cdFx0Ly8gTm90ZTogQSBuZXcgc29ja2V0IGlzIGNyZWF0ZWQgaGVyZSwgYXMgYWxsIGNvbW11bmljYXRpb25zIGZvciB0aGF0IHNlc3Npb24gd2lsbCBiZSBjcmVhdGVkIHdpdGggdGhpcyBuZXdseSBhY3F1aXJlZCBzb2NrZXRcblx0XHQvLyBUaGlzIGhlbHBzIHByZXZlbnQgdGhlIHNpdHVhdGlvbiB3aGVyZSBhIHNlc3Npb24gaXMgdGllZCB0byBhIHNpbmdsZSBzb2NrZXRcblx0XHR2YXIgcm9vbVNvY2tldDogU29ja2V0ID0gdGhpcy5nZXRTb2NrZXQoKTtcblxuXHRcdHJvb21Tb2NrZXQuZW1pdCgnam9pblJvb20nLCBvcHRpb25zLCAoc3VjY2VzcywgdG9rZW4pID0+IHtcblx0XHRcdGlmIChzdWNjZXNzKSB7XG5cdFx0XHRcdHZhciBjb250ZXh0OiBTdHJlYW1Sb29tID0gbmV3IFN0cmVhbVJvb20oc3RyZWFtcywgb3B0aW9ucywgcm9vbVNvY2tldCwgdG9rZW4pO1xuXHRcdFx0XHRjYWxsYmFjayhzdWNjZXNzLCBjb250ZXh0KTtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRjYWxsYmFjayhmYWxzZSwgbnVsbCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGdldFNvY2tldCgpOiBTb2NrZXQge1xuXHRcdHZhciBzb2NrZXQ6IFNvY2tldCA9IGlvLmNvbm5lY3QodGhpcy5jb25maWcudXJsLCB7cmVzb3VyY2U6ICdBL3NvY2tldC5pbycsICdmb3JjZSBuZXcgY29ubmVjdGlvbic6IHRydWV9KTtcblx0XHRyZXR1cm4gc29ja2V0O1xuXHR9XG59XG5cbmludGVyZmFjZSBSb29tRmlsdGVyUmVzdWx0Q2FsbGJhY2sge1xuICAgIChtZXNzYWdlOiBBcnJheTxSb29tT3B0aW9ucz4pOiB2b2lkO1xufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==